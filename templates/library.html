{% extends "base.html" %}

{% block title %}My Library - Movie Recommender{% endblock %}

{% block content %}
<h2 class="mb-20">üìö My Movie Library</h2>

<div class="glass-panel">
    <!-- Tabs Navigation -->
    <div class="tabs-nav">
        <button onclick="openTab(event, 'ToWatch')" class="tab-link active">üìå To Watch</button>
        <button onclick="openTab(event, 'Watched')" class="tab-link">‚úÖ Watched</button>
        <button onclick="openTab(event, 'Ratings')" class="tab-link">‚≠ê My Ratings</button>
    </div>

    <!-- To Watch Tab -->
    <div id="ToWatch" class="tab-content">
        <div class="grid-container">
            {% for movie in to_watch %}
            <div class="movie-card">
                <a href="/movie/{{ movie.id }}">
                    <img src="{{ movie.poster_url }}" class="movie-poster" alt="{{ movie.title }}">
                    <div class="movie-info">
                        <div class="title-text">{{ movie.title }}</div>
                        <div class="d-flex justify-between align-center">
                            <span class="subtitle-text">{{ movie.year }}</span>
                            <span class="rating-badge">‚òÖ {{ movie.vote_average_formatted }}</span>
                        </div>
                    </div>
                </a>
            </div>
            {% else %}
            <p>No movies in 'To Watch' list.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Watched Tab -->
    <div id="Watched" class="tab-content" style="display: none;">
        <div class="grid-container">
            {% for movie in watched %}
            <div class="movie-card">
                <a href="/movie/{{ movie.id }}">
                    <img src="{{ movie.poster_url }}" class="movie-poster" alt="{{ movie.title }}">
                    <div class="movie-info">
                        <div class="title-text">{{ movie.title }}</div>
                        <div class="d-flex justify-between align-center">
                            <span class="subtitle-text">{{ movie.year }}</span>
                            <span class="rating-badge">‚òÖ {{ movie.vote_average_formatted }}</span>
                        </div>
                    </div>
                </a>
            </div>
            {% else %}
            <p>No movies marked as 'Watched'.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Ratings Tab -->
    <div id="Ratings" class="tab-content" style="display: none;">
        <div class="grid-container">
            {% for movie in rated_movies %}
            <div class="movie-card">
                <a href="/movie/{{ movie.id }}">
                    <img src="{{ movie.poster_url }}" class="movie-poster" alt="{{ movie.title }}">
                    <div class="movie-info">
                        <div class="title-text">{{ movie.title }}</div>
                        <div class="d-flex justify-between align-center">
                            <span class="subtitle-text">{{ movie.year }}</span>
                            <span class="rating-badge"
                                style="background: #eab308; box-shadow: 0 4px 10px rgba(234, 179, 8, 0.3);">‚≠ê {{
                                movie.user_rating }}</span>
                        </div>
                    </div>
                </a>
            </div>
            {% else %}
            <p>No rated movies yet.</p>
            {% endfor %}
        </div>
    </div>
</div>

<script>
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tab-link");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].classList.remove("active");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.classList.add("active");
    }
</script>

{% endblock %}